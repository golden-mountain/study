import{_ as e,f as t,q as a,u as s,V as l,h as n,j as d,k as u,c as o,w as i,i as r,o as m,a as c,m as f,x as h,y as p,F as _,p as v,T as D,v as I,z as b,N as x,O as V}from"./index-h3lAx3Le.js";import{_ as g,a as k,b as U}from"./uni-forms.CfExgS4G.js";import{_ as j}from"./uni-section.CjICiUR3.js";import{U as y}from"./UserInfo.DLZ9WXF6.js";import{a as C}from"./auth.CK2ut5yY.js";const S=e({components:{UserInfo:y},data:()=>({user:{},studentData:{studentId:"",name:"",phone:"",role:["student"]},roles:[{value:"student",text:"学生"},{value:"monitor",text:"班长"},{value:"discipline",text:"纪委"},{value:"instructor",text:"辅导员"},{value:"admin",text:"管理员"}]}),onLoad(e){const a=C();a?(this.user=a,this.studentId=e.id,this.loadStudentInfo()):t({url:"/pages/auth/login"})},methods:{async loadStudentInfo(){const e=await a.callFunction({name:"user",data:{action:"get",studentId:this.studentId}});200===e.result.code&&(this.studentData=e.result.data,this.studentData.role.includes("student")||this.studentData.role.push("student"))},handleRoleChange(e){this.studentData.role=e.detail.value},async updateStudent(){const e={...this.studentData};delete e._id;const t=await a.callFunction({name:"user",data:{action:"update",studentId:this.studentData.studentId,...e}});200===t.result.code?(s({title:"修改成功"}),l()):s({title:t.result.msg||"修改失败",icon:"none"})}}},[["render",function(e,t,a,s,l,y){const C=v,S=r,F=n("UserInfo"),w=d(u("uni-easyinput"),g),q=d(u("uni-forms-item"),k),R=x,z=V,L=D,N=I,O=d(u("uni-forms"),U),T=d(u("uni-section"),j);return m(),o(S,{class:"container"},{default:i((()=>[c(S,{class:"navbar"},{default:i((()=>[c(S,{class:"left"},{default:i((()=>[c(C,{class:"title"},{default:i((()=>[f("修改学生信息")])),_:1})])),_:1}),c(F,{user:l.user},null,8,["user"])])),_:1}),c(T,{title:"修改学生信息",type:"line"},{default:i((()=>[c(O,{ref:"editStudentForm",model:l.studentData},{default:i((()=>[c(q,{label:"学号",name:"studentId"},{default:i((()=>[c(w,{modelValue:l.studentData.studentId,"onUpdate:modelValue":t[0]||(t[0]=e=>l.studentData.studentId=e),disabled:""},null,8,["modelValue"])])),_:1}),c(q,{label:"姓名",name:"name"},{default:i((()=>[c(w,{modelValue:l.studentData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>l.studentData.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),c(q,{label:"电话",name:"phone"},{default:i((()=>[c(w,{modelValue:l.studentData.phone,"onUpdate:modelValue":t[2]||(t[2]=e=>l.studentData.phone=e),placeholder:"请输入电话"},null,8,["modelValue"])])),_:1}),c(q,{label:"角色",name:"role"},{default:i((()=>[c(L,{onChange:y.handleRoleChange},{default:i((()=>[(m(!0),h(_,null,p(l.roles,(e=>(m(),o(z,{key:e.value,class:"checkbox-item"},{default:i((()=>[c(R,{value:e.value,checked:l.studentData.role.includes(e.value),disabled:"student"===e.value},null,8,["value","checked","disabled"]),c(C,null,{default:i((()=>[f(b(e.text),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["onChange"])])),_:1}),c(N,{onClick:y.updateStudent},{default:i((()=>[f("保存修改")])),_:1},8,["onClick"])])),_:1},8,["model"])])),_:1})])),_:1})}],["__scopeId","data-v-f95914d5"]]);export{S as default};
