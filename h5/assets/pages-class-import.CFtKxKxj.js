import{_ as t,s,f as e,u as a,q as n,V as l,h as o,j as u,k as i,c as d,w as c,i as r,o as p,a as m,m as f,p as I,W as h,v as _}from"./index-h3lAx3Le.js";import{_ as g}from"./uni-section.CjICiUR3.js";import{U as j}from"./UserInfo.DLZ9WXF6.js";import"./auth.CK2ut5yY.js";const v=t({components:{UserInfo:j},data:()=>({user:{},studentInput:"",classId:""}),onLoad(t){const a=s("user");a?(this.user=a,this.classId=t.classId):e({url:"/pages/auth/login"})},methods:{async importStudents(){if(!this.studentInput)return void a({title:"请输入学生信息",icon:"none"});const t=this.studentInput.split("\n").filter((t=>t.trim())).map((t=>{const[s,e,a]=t.split(/\s+/);return{studentId:s,name:e,phone:a,class:this.classId,role:["student"],password:s}})),s=await n.callFunction({name:"class",data:{action:"listMembers",classId:this.classId}});if(200===s.result.code){const e=s.result.data.map((t=>t.studentId)),o=t.filter((t=>!e.includes(t.studentId)));if(0===o.length)return void a({title:"没有新学生可导入",icon:"none"});const u=await n.callFunction({name:"class",data:{action:"importStudents",students:o}});200===u.result.code?(a({title:"导入成功"}),this.studentInput="",l()):a({title:u.result.msg||"导入失败",icon:"none"})}else a({title:s.result.msg||"获取学生列表失败",icon:"none"})}}},[["render",function(t,s,e,a,n,l){const j=I,v=r,U=o("UserInfo"),w=h,V=_,k=u(i("uni-section"),g);return p(),d(v,{class:"container"},{default:c((()=>[m(v,{class:"navbar"},{default:c((()=>[m(v,{class:"left"},{default:c((()=>[m(j,{class:"title"},{default:c((()=>[f("导入学生")])),_:1})])),_:1}),m(U,{user:n.user},null,8,["user"])])),_:1}),m(k,{title:"导入学生信息",type:"line"},{default:c((()=>[m(w,{modelValue:n.studentInput,"onUpdate:modelValue":s[0]||(s[0]=t=>n.studentInput=t),placeholder:"请输入学生信息，每行格式为：学号 姓名 电话",class:"input-area",maxlength:-1},null,8,["modelValue"]),m(V,{onClick:l.importStudents},{default:c((()=>[f("导入学生")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-022c9020"]]);export{v as default};
