import{_ as t,u as a,V as e,c as s,w as l,i as c,o as n,a as o,m as d,z as i,x as r,y as u,F as f,p as h,v as m,n as _}from"./index-h3lAx3Le.js";const p=t({data:()=>({className:"",date:"",stats:{total:0,attended:0,notChecked:0,leave:0},attendanceList:[]}),computed:{formattedDate(){return this.date?this.date:""},sortedAttendanceList(){return this.attendanceList&&Array.isArray(this.attendanceList)?[...this.attendanceList].sort(((t,a)=>{if(t.status!==a.status){if(0===t.status)return-1;if(0===a.status)return 1;if(2===t.status&&1===a.status)return-1;if(1===t.status&&2===a.status)return 1}return t.name.localeCompare(a.name,"zh-CN")})):[]},shareText(){return`${this.className}考勤数据\n日期：${this.formattedDate}\n总人数：${this.stats.total}，已打卡：${this.stats.attended}，未打卡：${this.stats.notChecked}，请假：${this.stats.leave}`}},onLoad(t){try{if(t.data){const a=JSON.parse(decodeURIComponent(t.data));this.className=a.courseInfo||"未知班级",this.date=a.date||(new Date).toLocaleDateString(),this.stats=a.stats||{total:0,attended:0,notChecked:0,leave:0},this.attendanceList=a.students||[],console.log("Processed data:",{className:this.className,date:this.date,stats:this.stats,attendanceList:this.attendanceList})}else console.error("No data provided in options"),a({title:"没有数据",icon:"none"})}catch(e){console.error("Error parsing data:",e),a({title:"数据加载失败",icon:"none"})}},methods:{getStatusClass(t){const a=t.status;return 0===a?"not-checked":1===a?"attended":2===a?"leave":""},getStatusText(t){const a=t.status;return 0===a?"未打卡":1===a?"已打卡":2===a?"请假":"未知"},formatTime(t){if(!t)return"--";if("number"==typeof t){const a=new Date(t);return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`}return t},copyShareLink(){const t=window.location.origin+window.location.pathname;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(t).then((()=>{this.showCopySuccess()})).catch((a=>{console.error("复制失败:",a),this.fallbackCopyText(t)})):this.fallbackCopyText(t)},fallbackCopyText(t){const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")?this.showCopySuccess():a({title:"复制失败，请手动复制",icon:"none"})}catch(s){console.error("复制失败:",s),a({title:"复制失败，请手动复制",icon:"none"})}document.body.removeChild(e)},showCopySuccess(){a({title:"链接已复制",icon:"success"})},goBack(){e()}}},[["render",function(t,a,e,p,y,C){const k=c,g=h,b=m;return n(),s(k,{class:"share-container"},{default:l((()=>[o(k,{class:"header"},{default:l((()=>[o(k,{class:"title"},{default:l((()=>[d(i(y.className)+" 考勤数据",1)])),_:1}),o(k,{class:"date"},{default:l((()=>[d(i(C.formattedDate),1)])),_:1}),o(k,{class:"stats-container"},{default:l((()=>[o(k,{class:"stat-card"},{default:l((()=>[o(k,{class:"stat-value"},{default:l((()=>[d(i(y.stats.total),1)])),_:1}),o(k,{class:"stat-label"},{default:l((()=>[d("总人数")])),_:1})])),_:1}),o(k,{class:"stat-card"},{default:l((()=>[o(k,{class:"stat-value"},{default:l((()=>[d(i(y.stats.attended),1)])),_:1}),o(k,{class:"stat-label"},{default:l((()=>[d("已打卡")])),_:1})])),_:1}),o(k,{class:"stat-card"},{default:l((()=>[o(k,{class:"stat-value"},{default:l((()=>[d(i(y.stats.notChecked),1)])),_:1}),o(k,{class:"stat-label"},{default:l((()=>[d("未打卡")])),_:1})])),_:1}),o(k,{class:"stat-card"},{default:l((()=>[o(k,{class:"stat-value"},{default:l((()=>[d(i(y.stats.leave),1)])),_:1}),o(k,{class:"stat-label"},{default:l((()=>[d("请假")])),_:1})])),_:1})])),_:1})])),_:1}),o(k,{class:"attendance-list"},{default:l((()=>[o(k,{class:"list-header"},{default:l((()=>[o(k,{class:"header-item name"},{default:l((()=>[d("姓名")])),_:1}),o(k,{class:"header-item status"},{default:l((()=>[d("状态")])),_:1}),o(k,{class:"header-item time"},{default:l((()=>[d("打卡时间")])),_:1})])),_:1}),0===y.attendanceList.length?(n(),s(k,{key:0,class:"empty-list"},{default:l((()=>[o(g,null,{default:l((()=>[d("暂无考勤数据")])),_:1})])),_:1})):(n(),s(k,{key:1,class:"list-body"},{default:l((()=>[(n(!0),r(f,null,u(C.sortedAttendanceList,((t,a)=>(n(),s(k,{key:a,class:_(["list-item",{odd:a%2==0}])},{default:l((()=>[o(k,{class:"item-cell name"},{default:l((()=>[d(i(t.name),1)])),_:2},1024),o(k,{class:"item-cell status"},{default:l((()=>[o(k,{class:_(["status-badge",C.getStatusClass(t)])},{default:l((()=>[d(i(C.getStatusText(t)),1)])),_:2},1032,["class"])])),_:2},1024),o(k,{class:"item-cell time"},{default:l((()=>[d(i(C.formatTime(t.time)),1)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1}))])),_:1}),o(k,{class:"actions"},{default:l((()=>[o(b,{class:"action-btn",onClick:C.copyShareLink},{default:l((()=>[d("复制链接")])),_:1},8,["onClick"]),o(b,{class:"action-btn",onClick:C.goBack},{default:l((()=>[d("返回")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-d4c11e27"]]);export{p as default};
